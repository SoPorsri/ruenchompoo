<!doctype html>
<html lang="th">
<head>
<meta charset="utf-8">
<title>Print POS Mobile Ready (Mock)</title>
<style>
  body { font-family: "Tahoma", "Noto Sans Thai", sans-serif; font-size:12px; }
  pre { background:#f4f4f4; padding:10px; white-space: pre-wrap; word-wrap: break-word; border:1px solid #ccc; }
  button { margin-top:10px; padding:5px 10px; font-size:14px; }
</style>
</head>
<body>
<h3>Preview ใบเสร็จ (ESC/POS)</h3>
<pre id="preview">ESC/POS preview here</pre>
<button id="printBtn">สั่งพิมพ์จริง</button>

<script>
const SERVER_URL = 'http://192.168.1.88:8080'; // มือถือ-ready
const PRINTER_IP = '192.168.1.100'; // mock IP

// ตัวอย่าง ESC/POS string
const ESCString = '*** ใบเสร็จตัวอย่าง ***\nสินค้า 1 x100\n================\n';

// แสดง preview
document.getElementById('preview').textContent = ESCString;

// ปุ่มสั่งพิมพ์
document.getElementById('printBtn').addEventListener('click', async ()=>{
  try {
    const resp = await fetch(`${SERVER_URL}/print`, {
      method:'POST',
      headers:{'Content-Type':'application/json'},
      body: JSON.stringify({printer_ip: PRINTER_IP, escpos: ESCString})
    });
    const result = await resp.json();
    if(result.success) alert('✅ สั่งพิมพ์สำเร็จ (mock)');
    else alert('❌ เกิดข้อผิดพลาด: '+result.message);
  } catch(e) {
    console.error(e);
    alert('❌ ไม่สามารถเชื่อมต่อ server');
  }
});
</script>
</body>
</html>
